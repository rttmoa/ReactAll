(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{3781:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/designer",function(){return n(4219)}])},4219:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var r=n(5893),o=n(6486),i=n(9008),s=n(1163),a=n(7294),c=n(8520),u=n.n(c),p=n(43);function f(e,t,n,r,o,i,s){try{var a=e[i](s),c=a.value}catch(u){return void n(u)}a.done?t(c):Promise.resolve(c).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){f(i,r,o,s,a,"next",e)}function a(e){f(i,r,o,s,a,"throw",e)}s(void 0)}))}}function d(){return(d=l(u().mark((function e(t,n){var r,o,i,s,a,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=void 0===n?{mode:"cors"}:n,o={"Content-Type":"application/json"},i=w(),!(s=(0,p.cD)())){e.next=8;break}o.Authorization=s,e.next=9;break;case 8:throw new Error("401");case 9:return r.headers=Object.assign({},o,r.headers),e.next=12,fetch("".concat(i).concat(t),r);case 12:if(401!==(a=e.sent).status){e.next=15;break}throw new Error("401");case 15:return e.next=17,a.json();case 17:if(!(c=e.sent).errors){e.next=21;break}throw console.error(c.errors),new Error("Failed to fetch API");case 21:return e.abrupt("return",c);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return d.apply(this,arguments)}function w(){if(window.location.search)return new URLSearchParams(window.location.search).get("steedosServerUrl")}function h(){if(window.location.search)return new URLSearchParams(window.location.search).get("reportId")}function v(){return(v=l(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h(),e.next=3,m("/api/stimulsoft-reports/view/".concat(t,"/mrt"));case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return v.apply(this,arguments)}function y(){return(y=l(u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h(),e.next=3,m("/api/stimulsoft-reports/view/".concat(t,"/database"));case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return y.apply(this,arguments)}function b(){return(b=l(u().mark((function e(t){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h(),e.next=3,m("/api/v4/stimulsoft_reports/".concat(n),{method:"PUT",body:JSON.stringify({report_mrt:t})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=function(e){var t={};return(0,o.map)(e,(function(e){t[e]=e})),t},D=function(e){var t=function(e){var t={};return(0,o.map)(e,(function(e,n){var r=(0,o.take)((0,o.keys)(e),5);t[n]={columns:r,columnsText:x(r),sort:[],filterMode:"And",filterOn:!0,filterEngine:"ReportEngine",filters:[],groups:[],totals:{},typeItem:"DataSource"}})),t}(e);return{dataSources:t,reportOptions:{orientation:"Portrait",unit:"cm",language:"C",componentType:"Data",theme:"Red_50",dataSourcesOrder:(0,o.keys)(t),relations:{}}}};function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,t){return!t||"object"!==R(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var R=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},T=function(e){function t(){return O(this,t),C(this,k(t).apply(this,arguments))}var n,i,s;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,e),n=t,(i=[{key:"render",value:function(){return(0,r.jsx)("div",{id:"designer"})}},{key:"componentDidMount",value:function(){Promise.all([g(),S()]).then((function(e){var t=e[0],n=e[1];console.log("Loading Designer view"),window.Stimulsoft.Base.Localization.StiLocalization.addLocalizationFile("./localization/zh-CHS.xml",!1,"Chinese (Simplified)"),window.Stimulsoft.Base.Localization.StiLocalization.cultureName="Chinese (Simplified)",window.Stimulsoft.Base.StiLicense.key="6vJhGtLLLz2GNviWmUTrhSqnOItdDwjBylQzQcAOiHkIgEtgNGLrcCAzNbMl6zD76vDUvAJYd/qfKVOIhOV2xa7MFpPnj6I+SHYphEf0U7T6TW9TOJg1Fz7kEfoMUWgpO4wRcoSSWvw/DoVCUExtkTajYx5MYiz4hAjSQWqwFYoOQB5aCxhwF4qimKCX3qE3xnYVGDOs7i+voPRKQ4KFDmAHw4g8TOoMLwk1rNdlHHUgDsix6vBWnV7cVJFMXrJEs5a6MTBdKgoweUZwI/6ZzLJcHYTbq+0niFE5D5J0wV9XmygtKGTDR5j53B+uv4OkW5tyiKtSAsi/AcXeYk+YRsSIJbU0unb3aEaMMD2QS1Ss9ess6PCI2fUTF8ZRvBTYVgV07rSa+oO3CUbI8EzrbR8xuG4Afm62FR65dr1+XqASeFkhSGM+yp7NNkE0ijDbpgK95+vBAPyyXwy1s40HSabQyL3+wYmLZ/lwIhMSfE31OyCvw1DO40D9kry/u+bABXg0Y48rg3qb2pO0spOiUflDLMSR7ZifXdVAQCfOpwQUgbEXH3gjxOnYIlMMu8lLChNQQDp/THN6W1bd0BL7WtKMo/8aTmEIlS2RhkopDuo=",console.log("Set full screen mode for the designer");var r=new window.Stimulsoft.Designer.StiDesignerOptions;r.appearance.fullScreenMode=!1,console.log("Create the report designer with specified options");var i=new window.Stimulsoft.Designer.StiDesigner(r,"StiDesigner",!1);i.onSaveReport=function(e){!function(e){b.apply(this,arguments)}(e.report.saveToJsonString())},window.Stimulsoft.Report.Dictionary.StiCustomDatabase.registerCustomDatabase(function(e){var t=e.serviceName,n=e.sampleConnectionString,r=e.data,o=e.types;return{serviceName:t,sampleConnectionString:n,process:function(e,t){"TestConnection"==e.command&&t({success:!1,notice:"Error"}),"RetrieveSchema"==e.command&&t({success:!0,data:r,types:o}),"RetrieveData"==e.command&&t({success:!0,data:r[e.queryString],types:o[e.queryString]})}}}(n));var s=null;(0,o.isEmpty)(t)?(console.log("Create a new report mrt instance"),s=function(e){var t=new window.Stimulsoft.Report.StiReport;t.reportUnit=0,t.pages.getByIndex(0).paperSize=window.Stimulsoft.System.Drawing.Printing.PaperKind.Custom,t.pages.getByIndex(0).pageWidth=t.unit.convertFromHInches(827),t.pages.getByIndex(0).pageHeight=t.unit.convertFromHInches(1169),t.info.zoom=1;var n=D(e.types),r=new window.Stimulsoft.Report.Dictionary.StiCustomDatabase(e.serviceName,e.serviceName,e.sampleConnectionString);return r.serviceName=e.serviceName,t.dictionary.databases.addRange([r]),(0,o.each)(e.types,(function(n,i){var s=r.createDataSource(e.serviceName,i);s.sqlCommand=i,(0,o.each)(n,(function(e,t){s.columns.add(new window.Stimulsoft.Report.Dictionary.StiDataColumn(t,t,t,e))})),t.dictionary.dataSources.add(s)})),t=window.Stimulsoft.Designer.StiWizardHelper.getReportFromWizardOptions(t,n.reportOptions,n.dataSources)}(n)):(console.log("Create a new report instance"),(s=new window.Stimulsoft.Report.StiReport).loadDocument(t)),console.log("Edit report template in the designer"),i.report=s,i.renderHtml("designer")}))}}])&&j(n.prototype,i),s&&j(n,s),t}(a.Component),_=function(){(0,s.useRouter)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.default,{children:[(0,r.jsx)("title",{children:"Steedos Reports Designer"}),(0,r.jsx)("link",{rel:"stylesheet",href:"./css/stimulsoft.designer.office2013.whiteblue.css"}),(0,r.jsx)("link",{rel:"stylesheet",href:"./css/stimulsoft.viewer.office2013.whiteblue.css"}),(0,r.jsx)("script",{src:"./scripts/stimulsoft.reports.js"}),(0,r.jsx)("script",{src:"./scripts/stimulsoft.viewer.js"}),(0,r.jsx)("script",{src:"./scripts/stimulsoft.designer.js"}),(0,r.jsx)("script",{src:"./scripts/stimulsoft.blockly.js"})]}),(0,r.jsx)("div",{id:"main",children:(0,r.jsx)(T,{})})]})}},9008:function(e,t,n){e.exports=n(5443)},1163:function(e,t,n){e.exports=n(387)}},function(e){e.O(0,[774,888,179],(function(){return t=3781,e(e.s=t);var t}));var t=e.O();_N_E=t}]);