{
    "name": "accounts",
    "fields": {
        "name": {
            "label": "客户名",
            "type": "text",
            "searchable": true,
            "required": true,
            "sortable": true,
            "index": true,
            "name": "name",
            "sort_no": 10
        },
        "owner": {
            "label": "所有者",
            "sortable": true,
            "omit": false,
            "hidden": false,
            "sort_no": 20,
            "type": "lookup",
            "reference_to": "users",
            "index": true,
            "defaultValue": "{userId}",
            "name": "owner"
        },
        "is_supplier": {
            "type": "boolean",
            "label": "供应商",
            "hidden": true,
            "omit": true,
            "sort_no": 30,
            "name": "is_supplier"
        },
        "is_customer": {
            "type": "boolean",
            "label": "客户",
            "hidden": true,
            "omit": true,
            "sort_no": 40,
            "name": "is_customer"
        },
        "type": {
            "label": "类型",
            "type": "select",
            "sortable": true,
            "options": [
                {
                    "label": "分析师",
                    "value": "Analyst"
                },
                {
                    "label": "竞争者",
                    "value": "Competitor"
                },
                {
                    "label": "顾客",
                    "value": "Customer"
                },
                {
                    "label": "集成商",
                    "value": "Integrator"
                },
                {
                    "label": "投资者",
                    "value": "Investor"
                },
                {
                    "label": "合作伙伴",
                    "value": "Partner"
                },
                {
                    "label": "公关媒体",
                    "value": "Press"
                },
                {
                    "label": "潜在",
                    "value": "Prospect"
                },
                {
                    "label": "代理商",
                    "value": "Reseller"
                },
                {
                    "label": "其他",
                    "value": "Other"
                }
            ],
            "filterable": true,
            "sort_no": 50,
            "name": "type"
        },
        "parent_id": {
            "type": "lookup",
            "label": "母公司",
            "reference_to": "accounts",
            "inlineHelpText": "作为大公司或组织的子公司的母公司。父级客户必须是华炎魔方中的现有客户。您可输入客户名，或使用查找图标选择（或创建）客户。",
            "sort_no": 60,
            "name": "parent_id"
        },
        "credit_code": {
            "type": "text",
            "label": "纳税人识别号（身份证/其他）",
            "name": "credit_code",
            "searchable": true,
            "sort_no": 70
        },
        "website": {
            "type": "url",
            "label": "网站",
            "sort_no": 80,
            "name": "website"
        },
        "phone": {
            "type": "text",
            "label": "电话",
            "defaultValue": "",
            "sort_no": 90,
            "name": "phone"
        },
        "fax": {
            "type": "text",
            "label": "传真",
            "sort_no": 100,
            "name": "fax"
        },
        "description": {
            "label": "描述",
            "type": "textarea",
            "is_wide": true,
            "name": "description",
            "sort_no": 110
        },
        "industry": {
            "type": "select",
            "label": "行业",
            "searchable": true,
            "sortable": true,
            "options": [
                {
                    "label": "农业",
                    "value": "Agriculture"
                },
                {
                    "label": "服饰",
                    "value": "Apparel"
                },
                {
                    "label": "银行",
                    "value": "Banking"
                },
                {
                    "label": "生物科技",
                    "value": "Biotechnology"
                },
                {
                    "label": "化工",
                    "value": "Chemicals"
                },
                {
                    "label": "通信",
                    "value": "Communications"
                },
                {
                    "label": "建筑",
                    "value": "Construction"
                },
                {
                    "label": "咨询",
                    "value": "Consulting"
                },
                {
                    "label": "教育",
                    "value": "Education"
                },
                {
                    "label": "电子",
                    "value": "Electronics"
                },
                {
                    "label": "能源",
                    "value": "Energy"
                },
                {
                    "label": "工程",
                    "value": "Engineering"
                },
                {
                    "label": "娱乐",
                    "value": "Entertainment"
                },
                {
                    "label": "环保",
                    "value": "Environmental"
                },
                {
                    "label": "金融",
                    "value": "Finance"
                },
                {
                    "label": "食品饮料",
                    "value": "Food_&_Beverage"
                },
                {
                    "label": "政府组织",
                    "value": "Government"
                },
                {
                    "label": "医疗保健",
                    "value": "Healthcare"
                },
                {
                    "label": "服务",
                    "value": "Hospitality"
                },
                {
                    "label": "保险",
                    "value": "Insurance"
                },
                {
                    "label": "机械",
                    "value": "Machinery"
                },
                {
                    "label": "制造",
                    "value": "Manufacturing"
                },
                {
                    "label": "媒体",
                    "value": "Media"
                },
                {
                    "label": "非牟利组织",
                    "value": "Not_For_Profit"
                },
                {
                    "label": "其他",
                    "value": "Other"
                },
                {
                    "label": "休闲",
                    "value": "Recreation"
                },
                {
                    "label": "零售",
                    "value": "Retail"
                },
                {
                    "label": "航运",
                    "value": "Shipping"
                },
                {
                    "label": "科技",
                    "value": "Technology"
                },
                {
                    "label": "电讯",
                    "value": "Telecommunications"
                },
                {
                    "label": "交通运输",
                    "value": "Transportation"
                },
                {
                    "label": "公用事业",
                    "value": "Utilities"
                }
            ],
            "filterable": true,
            "sort_no": 120,
            "name": "industry"
        },
        "number_of_employees": {
            "type": "number",
            "label": "员工人数",
            "sort_no": 130,
            "name": "number_of_employees"
        },
        "state": {
            "label": "区域",
            "type": "select",
            "sortable": true,
            "options": [
                {
                    "label": "北京",
                    "value": "BJ"
                },
                {
                    "label": "上海",
                    "value": "SH"
                },
                {
                    "label": "重庆",
                    "value": "CQ"
                },
                {
                    "label": "天津",
                    "value": "TJ"
                },
                {
                    "label": "河北",
                    "value": "HB"
                },
                {
                    "label": "山西",
                    "value": "SX"
                },
                {
                    "label": "辽宁",
                    "value": "LN"
                },
                {
                    "label": "吉林",
                    "value": "GL"
                },
                {
                    "label": "黑龙江",
                    "value": "HLJ"
                },
                {
                    "label": "江苏",
                    "value": "JS"
                },
                {
                    "label": "浙江",
                    "value": "ZJ"
                },
                {
                    "label": "安徽",
                    "value": "AH"
                },
                {
                    "label": "福建",
                    "value": "FJ"
                },
                {
                    "label": "江西",
                    "value": "JX"
                },
                {
                    "label": "山东",
                    "value": "SD"
                },
                {
                    "label": "河南",
                    "value": "HN"
                },
                {
                    "label": "湖北",
                    "value": "HUB"
                },
                {
                    "label": "湖南",
                    "value": "HUN"
                },
                {
                    "label": "广东",
                    "value": "GD"
                },
                {
                    "label": "海南",
                    "value": "HAN"
                },
                {
                    "label": "四川",
                    "value": "SC"
                },
                {
                    "label": "贵州",
                    "value": "GZ"
                },
                {
                    "label": "云南",
                    "value": "YN"
                },
                {
                    "label": "陕西",
                    "value": "SHX"
                },
                {
                    "label": "甘肃",
                    "value": "GS"
                },
                {
                    "label": "青海",
                    "value": "QH"
                },
                {
                    "label": "内蒙古",
                    "value": "NMG"
                },
                {
                    "label": "广西",
                    "value": "GX"
                },
                {
                    "label": "西藏",
                    "value": "XZ"
                },
                {
                    "label": "宁夏",
                    "value": "NX"
                },
                {
                    "label": "新疆",
                    "value": "XJ"
                },
                {
                    "label": "香港",
                    "value": "HK"
                },
                {
                    "label": "澳门",
                    "value": "AM"
                },
                {
                    "label": "台湾",
                    "value": "TW"
                }
            ],
            "filterable": true,
            "inlineHelpText": "客户被分配至的区域。",
            "sort_no": 140,
            "name": "state"
        },
        "billing_address": {
            "type": "textarea",
            "label": "开单地址",
            "rows": 3,
            "group": "地址信息",
            "sort_no": 150,
            "name": "billing_address"
        },
        "shipping_address": {
            "type": "textarea",
            "label": "发货地址",
            "rows": 3,
            "group": "地址信息",
            "sort_no": 160,
            "name": "shipping_address"
        },
        "account_number": {
            "type": "text",
            "label": "客户编号",
            "hidden": true,
            "sort_no": 170,
            "name": "account_number"
        },
        "rating": {
            "label": "分级",
            "type": "select",
            "sortable": true,
            "options": [
                {
                    "label": "非常重要",
                    "value": "Hot"
                },
                {
                    "label": "重要",
                    "value": "Warm"
                },
                {
                    "label": "普通",
                    "value": "Cold"
                }
            ],
            "filterable": true,
            "inlineHelpText": "您如何划分此客户等级的分类，例如，普通、重要。",
            "sort_no": 180,
            "name": "rating"
        },
        "invoice_address": {
            "label": "开票地址",
            "group": "开票信息",
            "type": "text",
            "name": "invoice_address",
            "sort_no": 190
        },
        "invoice_phone": {
            "label": "开票电话",
            "group": "开票信息",
            "type": "text",
            "name": "invoice_phone",
            "sort_no": 200
        },
        "invoice_bank": {
            "label": "开户行",
            "group": "开票信息",
            "type": "text",
            "name": "invoice_bank",
            "sort_no": 210
        },
        "invoice_combinenum": {
            "label": "账号",
            "group": "开票信息",
            "type": "text",
            "name": "invoice_combinenum",
            "sort_no": 220
        },
        "account_source": {
            "type": "text",
            "label": "客户来源",
            "hidden": true,
            "sort_no": 230,
            "name": "account_source"
        },
        "site": {
            "type": "text",
            "label": "客户地点",
            "hidden": true,
            "inlineHelpText": "可用客户地点字段来指定同一公司的不同位置。例如，假设百度在北京和上海均设有办公室。创建两个名为百度的客户，但是客户地点的值分别为北京和上海。",
            "sort_no": 240,
            "name": "site"
        },
        "annual_revenue": {
            "label": "年收入",
            "type": "currency",
            "hidden": false,
            "sort_no": 250,
            "name": "annual_revenue"
        },
        "ownership": {
            "label": "所有权",
            "type": "select",
            "sortable": true,
            "options": [
                {
                    "label": "国营",
                    "value": "National"
                },
                {
                    "label": "私营",
                    "value": "Private"
                },
                {
                    "label": "子公司",
                    "value": "Subcompany"
                },
                {
                    "label": "其他",
                    "value": "Others"
                }
            ],
            "inlineHelpText": "公司的所有权，例如，公有或私有。",
            "hidden": true,
            "sort_no": 260,
            "name": "ownership"
        },
        "account_division": {
            "label": "客户分部",
            "type": "text",
            "hidden": true,
            "sort_no": 270,
            "name": "account_division"
        },
        "partner_account": {
            "label": "合作伙伴客户",
            "type": "boolean",
            "hidden": true,
            "sort_no": 280,
            "name": "partner_account"
        },
        "assistant": {
            "label": "助理",
            "type": "text",
            "hidden": true,
            "sort_no": 290,
            "name": "assistant"
        },
        "asst_phone": {
            "label": "助理电话",
            "type": "text",
            "hidden": true,
            "sort_no": 300,
            "name": "asst_phone"
        },
        "birthdate": {
            "label": "生日",
            "type": "date",
            "hidden": true,
            "sort_no": 310,
            "name": "birthdate"
        },
        "department": {
            "label": "部门",
            "type": "text",
            "sort_no": 320,
            "name": "department"
        },
        "email": {
            "label": "电子邮件",
            "type": "email",
            "sort_no": 330,
            "name": "email"
        },
        "do_not_call": {
            "label": "请勿致电",
            "type": "boolean",
            "inlineHelpText": "是否想要通过电话联系联系人。",
            "hidden": true,
            "sort_no": 340,
            "name": "do_not_call"
        },
        "has_opted_out_of_email": {
            "label": "退出邮件列表",
            "type": "boolean",
            "inlineHelpText": "是否将联系人包含在群发邮件列表中。",
            "hidden": true,
            "sort_no": 350,
            "name": "has_opted_out_of_email"
        },
        "fax_opt_out": {
            "label": "退出传真列表",
            "type": "boolean",
            "inlineHelpText": "是否将联系人包含在传真中。",
            "hidden": true,
            "sort_no": 360,
            "name": "fax_opt_out"
        },
        "home_phone": {
            "label": "家庭电话",
            "type": "text",
            "hidden": true,
            "sort_no": 370,
            "name": "home_phone"
        },
        "lead_source": {
            "type": "select",
            "label": "潜在客户来源",
            "searchable": true,
            "sortable": true,
            "options": [
                {
                    "label": "广告",
                    "value": "Advertisement"
                },
                {
                    "label": "客户活动",
                    "value": "Customer_Event"
                },
                {
                    "label": "员工推荐",
                    "value": "Employee_Referral"
                },
                {
                    "label": "百度搜索",
                    "value": "Baidu_AdWords"
                },
                {
                    "label": "其他",
                    "value": "Other"
                },
                {
                    "label": "合作伙伴",
                    "value": "Partner"
                },
                {
                    "label": "采购清单",
                    "value": "Purchased_List"
                },
                {
                    "label": "贸易展览",
                    "value": "Trade_Show"
                },
                {
                    "label": "线上研讨",
                    "value": "Webinar"
                },
                {
                    "label": "网站",
                    "value": "Website"
                }
            ],
            "filterable": true,
            "inlineHelpText": "潜在客户来源，例如，广告、合作伙伴或 Web。",
            "hidden": true,
            "sort_no": 380,
            "name": "lead_source"
        },
        "mailing_city": {
            "type": "text",
            "label": "邮寄地址-城市",
            "group": "地址信息",
            "hidden": true,
            "sort_no": 390,
            "name": "mailing_city"
        },
        "mailing_street": {
            "type": "text",
            "label": "邮寄地址-街道",
            "group": "地址信息",
            "hidden": true,
            "sort_no": 400,
            "name": "mailing_street"
        },
        "mailing_zip": {
            "type": "text",
            "label": "邮寄地址-邮政编码",
            "group": "地址信息",
            "hidden": true,
            "sort_no": 410,
            "name": "mailing_zip"
        },
        "other_city": {
            "type": "text",
            "label": "其他地址-城市",
            "group": "其他地址信息",
            "hidden": true,
            "sort_no": 420,
            "name": "other_city"
        },
        "other_street": {
            "type": "text",
            "label": "其他地址-街道",
            "group": "其他地址信息",
            "hidden": true,
            "sort_no": 430,
            "name": "other_street"
        },
        "other_zip": {
            "type": "text",
            "label": "其他地址-邮政编码",
            "group": "其他地址信息",
            "hidden": true,
            "sort_no": 440,
            "name": "other_zip"
        },
        "mobile": {
            "label": "手机",
            "type": "text",
            "sort_no": 450,
            "name": "mobile"
        },
        "salutation": {
            "type": "select",
            "label": "性别",
            "options": [
                {
                    "label": "男",
                    "value": "Male"
                },
                {
                    "label": "女",
                    "value": "Female"
                }
            ],
            "sort_no": 460,
            "name": "salutation"
        },
        "other_phone": {
            "label": "其他电话",
            "type": "text",
            "hidden": true,
            "sort_no": 470,
            "name": "other_phone"
        },
        "summary__c": {
            "_id": "PmZPNLND5srL423nh",
            "object": "accounts",
            "label": "累计汇总",
            "_name": "summary",
            "type": "summary",
            "precision": 18,
            "scale": 2,
            "summary_object": "contacts",
            "summary_type": "count",
            "sort_no": 480,
            "is_name": false,
            "required": false,
            "is_wide": false,
            "readonly": false,
            "hidden": false,
            "omit": false,
            "index": false,
            "sortable": false,
            "searchable": false,
            "filterable": false,
            "space": "wspdRw3z3gqkWBWWF",
            "formula_blank_value": "zeroes",
            "owner": "5ff3fc3d521ab003d0293acf",
            "created": "2021-03-02T09:14:07.193Z",
            "modified": "2021-03-02T09:14:07.193Z",
            "created_by": "5ff3fc3d521ab003d0293acf",
            "modified_by": "5ff3fc3d521ab003d0293acf",
            "company_id": "3TyAbA3xYadmNgDtd",
            "company_ids": [
                "3TyAbA3xYadmNgDtd"
            ],
            "name": "summary__c",
            "data_type": "number"
        },
        "startdate__c": {
            "_id": "GBkXQotzET2J6jgc7",
            "object": "accounts",
            "label": "开始日期",
            "_name": "startdate",
            "type": "date",
            "sort_no": 490,
            "is_name": false,
            "required": false,
            "is_wide": false,
            "readonly": false,
            "hidden": false,
            "omit": false,
            "index": false,
            "sortable": false,
            "searchable": false,
            "filterable": false,
            "space": "wspdRw3z3gqkWBWWF",
            "precision": 18,
            "scale": 2,
            "formula_blank_value": "zeroes",
            "owner": "5ff3fc3d521ab003d0293acf",
            "created": "2021-03-17T03:50:23.704Z",
            "modified": "2021-03-17T03:50:23.704Z",
            "created_by": "5ff3fc3d521ab003d0293acf",
            "modified_by": "5ff3fc3d521ab003d0293acf",
            "company_id": "3TyAbA3xYadmNgDtd",
            "company_ids": [
                "3TyAbA3xYadmNgDtd"
            ],
            "name": "startdate__c"
        },
        "datetime__c": {
            "_id": "KebKrBuzWwYkwj8fE",
            "object": "accounts",
            "label": "开始具体日期",
            "_name": "datetime",
            "type": "datetime",
            "sort_no": 500,
            "is_name": false,
            "required": false,
            "is_wide": false,
            "readonly": false,
            "hidden": false,
            "omit": false,
            "index": false,
            "sortable": false,
            "searchable": false,
            "filterable": false,
            "space": "wspdRw3z3gqkWBWWF",
            "precision": 18,
            "scale": 2,
            "formula_blank_value": "zeroes",
            "owner": "5ff3fc3d521ab003d0293acf",
            "created": "2021-03-17T03:50:57.415Z",
            "modified": "2021-03-17T03:50:57.415Z",
            "created_by": "5ff3fc3d521ab003d0293acf",
            "modified_by": "5ff3fc3d521ab003d0293acf",
            "company_id": "3TyAbA3xYadmNgDtd",
            "company_ids": [
                "3TyAbA3xYadmNgDtd"
            ],
            "name": "datetime__c"
        },
        "space": {
            "type": "text",
            "label": "所属工作区",
            "reference_to": "spaces",
            "index": true,
            "hidden": true,
            "defaultValue": "{spaceId}",
            "name": "space"
        },
        "created": {
            "type": "datetime",
            "label": "创建时间",
            "readonly": true,
            "sortable": true,
            "omit": true,
            "name": "created"
        },
        "created_by": {
            "label": "创建人",
            "type": "lookup",
            "readonly": true,
            "reference_to": "users",
            "disabled": true,
            "index": true,
            "omit": true,
            "name": "created_by"
        },
        "modified": {
            "label": "修改时间",
            "type": "datetime",
            "readonly": true,
            "sortable": true,
            "index": true,
            "omit": true,
            "name": "modified"
        },
        "modified_by": {
            "label": "修改人",
            "type": "lookup",
            "readonly": true,
            "reference_to": "users",
            "disabled": true,
            "omit": true,
            "name": "modified_by"
        },
        "is_deleted": {
            "type": "boolean",
            "label": "已删除",
            "omit": true,
            "index": true,
            "hidden": true,
            "name": "is_deleted"
        },
        "deleted": {
            "label": "删除时间",
            "type": "datetime",
            "readonly": true,
            "sortable": true,
            "index": true,
            "omit": true,
            "hidden": true,
            "name": "deleted"
        },
        "deleted_by": {
            "label": "删除人",
            "type": "lookup",
            "readonly": true,
            "reference_to": "users",
            "disabled": true,
            "omit": true,
            "hidden": true,
            "name": "deleted_by"
        },
        "instances": {
            "label": "申请单",
            "type": "grid",
            "omit": true,
            "hidden": true,
            "name": "instances"
        },
        "instances.$._id": {
            "label": "申请单ID",
            "type": "text",
            "omit": true,
            "hidden": true,
            "name": "instances.$._id"
        },
        "instances.$.state": {
            "label": "申请单状态",
            "type": "text",
            "omit": true,
            "hidden": true,
            "name": "instances.$.state"
        },
        "sharing": {
            "label": "记录级权限",
            "type": "grid",
            "omit": true,
            "hidden": true,
            "blackbox": true,
            "name": "sharing"
        },
        "sharing.$": {
            "label": "授权条件",
            "blackbox": true,
            "omit": true,
            "hidden": true,
            "name": "sharing.$"
        },
        "sharing.$.u": {
            "label": "授权用户",
            "type": "[text]",
            "omit": true,
            "hidden": true,
            "name": "sharing.$.u"
        },
        "sharing.$.o": {
            "label": "授权组织",
            "type": "[text]",
            "omit": true,
            "hidden": true,
            "name": "sharing.$.o"
        },
        "sharing.$.r": {
            "label": "来自规则",
            "type": "text",
            "omit": true,
            "hidden": true,
            "name": "sharing.$.r"
        },
        "message_count": {
            "label": "留言数",
            "type": "number",
            "omit": true,
            "hidden": true,
            "name": "message_count"
        },
        "locked": {
            "label": "已锁定",
            "type": "boolean",
            "omit": true,
            "hidden": true,
            "name": "locked"
        },
        "company_id": {
            "label": "主分部",
            "type": "lookup",
            "reference_to": "company",
            "sortable": true,
            "index": true,
            "omit": true,
            "hidden": true,
            "name": "company_id",
            "_optionsFunction": "function anonymous(values\n) {\n\n  var object = Creator.getObject(values._object_name);\n  if(!object){\n    console.error(\"未找到当前对象：\" + values._object_name);\n    return [];\n  }\n  var perms = object.permissions.get();\n  var options, result, companys, queryFilters;\n  result = [];\n  options = {\n    $select: 'name'\n  };\n  \n  if(perms.modifyAllRecords){\n    /* 如果当前用户对当前业务对象的权限为 modifyAllRecords，那选择分部时可以能从所有分部中选择。*/\n  }\n  else{\n    /* 如果当前用户对当前业务对象的权限为 modifyCompanyRecords，那选择分部时只能从当前用户所属分部中选择。*/\n    var company_ids = Creator.USER_CONTEXT.user.company_ids;\n    if(!company_ids.length){\n      console.warn(\"当前用户不属于任何分部，无权修改该字段。\");\n      queryFilters = [\"_id\", \"=\", -1];\n    }else{\n      queryFilters = [\"_id\", \"in\", company_ids];\n    }\n  }\n  var customFilters = this.filters;\n  if(!_.isEmpty(customFilters)){\n    if(_.isEmpty(queryFilters)){\n      queryFilters = customFilters;\n    }\n    else{\n      queryFilters = [customFilters, 'and', queryFilters];\n    }\n  }\n  if(!_.isEmpty(queryFilters) && this.template && this.template.data && this.template.data._value && this.template.data._value.length){\n    var _value = this.template.data._value;\n    /* \n      this.template.data._value为原来数据库中返回的选项值，需要始终能兼容返回 \n      values.company_id 及 this.template.data.value为当前用户选中的选项，能选中肯定是本来就在列表中的，所以不需要兼容返回\n    */\n    queryFilters = [queryFilters, 'or', [\"_id\", \"=\", _value]];\n  }\n  if(!_.isEmpty(queryFilters)){\n    var steedosFilters = require(\"@steedos/filters\");\n    var odataFilter = steedosFilters.formatFiltersToODataQuery(queryFilters);\n    options.$filter = odataFilter;\n  }\n  companys = Creator.odata.query('company', options, true);\n  companys.forEach(function (item) {\n    result.push({\n      label: item.name,\n      value: item._id\n    });\n  });\n  return result;\n\n}",
            "_defaultValue": "function anonymous(\n) {\n\n  if(Meteor.isClient){\n    return Steedos.getUserCompanyId()\n  }\n\n}"
        },
        "company_ids": {
            "label": "所属分部",
            "type": "lookup",
            "reference_to": "company",
            "sortable": true,
            "index": true,
            "multiple": true,
            "omit": true,
            "hidden": true,
            "name": "company_ids",
            "_optionsFunction": "function anonymous(values\n) {\n\n  var object = Creator.getObject(values._object_name);\n  if(!object){\n    console.error(\"未找到当前对象：\" + values._object_name);\n    return [];\n  }\n  var perms = object.permissions.get();\n  var options, result, companys, queryFilters;\n  result = [];\n  options = {\n    $select: 'name'\n  };\n  \n  if(perms.modifyAllRecords){\n    /* 如果当前用户对当前业务对象的权限为 modifyAllRecords，那选择分部时可以能从所有分部中选择。*/\n  }\n  else{\n    /* 如果当前用户对当前业务对象的权限为 modifyCompanyRecords，那选择分部时只能从当前用户所属分部中选择。*/\n    var company_ids = Creator.USER_CONTEXT.user.company_ids;\n    if(!company_ids.length){\n      console.warn(\"当前用户不属于任何分部，无权修改该字段。\");\n      queryFilters = [\"_id\", \"=\", -1];\n    }else{\n      queryFilters = [\"_id\", \"in\", company_ids];\n    }\n  }\n  var customFilters = this.filters;\n  if(!_.isEmpty(customFilters)){\n    if(_.isEmpty(queryFilters)){\n      queryFilters = customFilters;\n    }\n    else{\n      queryFilters = [customFilters, 'and', queryFilters];\n    }\n  }\n  if(!_.isEmpty(queryFilters) && this.template && this.template.data && this.template.data._value && this.template.data._value.length){\n    var _value = this.template.data._value;\n    /* \n      this.template.data._value为原来数据库中返回的选项值，需要始终能兼容返回 \n      values.company_ids 及 this.template.data.value为当前用户选中的选项，能选中肯定是本来就在列表中的，所以不需要兼容返回\n    */\n    queryFilters = [queryFilters, 'or', [\"_id\", \"in\", _value]];\n  }\n  if(!_.isEmpty(queryFilters)){\n    var steedosFilters = require(\"@steedos/filters\");\n    var odataFilter = steedosFilters.formatFiltersToODataQuery(queryFilters);\n    options.$filter = odataFilter;\n  }\n  companys = Creator.odata.query('company', options, true);\n  companys.forEach(function (item) {\n    result.push({\n      label: item.name,\n      value: item._id\n    });\n  });\n  return result;\n\n}",
            "_defaultValue": "function anonymous(\n) {\n\n  if(Meteor.isClient){\n    var companyId = Steedos.getUserCompanyId();\n    if(companyId){\n      return [companyId]\n    }\n    else{\n      return []\n    }\n  }\n\n}"
        },
        "instance_state": {
            "label": "审批状态",
            "type": "select",
            "options": [
                {
                    "label": "草稿",
                    "value": "draft"
                },
                {
                    "label": "进行中",
                    "value": "pending"
                },
                {
                    "label": "已完成",
                    "value": "completed"
                },
                {
                    "label": "已核准",
                    "value": "approved"
                },
                {
                    "label": "已驳回",
                    "value": "rejected"
                },
                {
                    "label": "已取消",
                    "value": "terminated"
                }
            ],
            "omit": true,
            "hidden": true,
            "name": "instance_state"
        },
        "_table": {
            "label": "记录对象流程映射功能中表单中表格行信息",
            "type": "object",
            "omit": true,
            "hidden": true,
            "name": "_table"
        },
        "_table._id": {
            "type": "text",
            "label": "Object Workflow Related Form Table Item ID",
            "omit": true,
            "hidden": true,
            "name": "_table._id"
        },
        "_table._code": {
            "type": "text",
            "label": "Object Workflow Related Form Table Code",
            "omit": true,
            "hidden": true,
            "name": "_table._code"
        },
        "html__c": {
            "object": "accounts",
            "label": "Html文本",
            "_name": "html",
            "type": "html",
            "sort_no": 510,
            "is_name": false,
            "required": false,
            "is_wide": true,
            "readonly": false,
            "hidden": false,
            "omit": false,
            "index": false,
            "sortable": false,
            "searchable": false,
            "filterable": false,
            "space": "wspdRw3z3gqkWBWWF",
            "precision": 18,
            "scale": 2,
            "formula_blank_value": "zeroes",
            "owner": "5ff3fc3d521ab003d0293acf",
            "_id": "8xmoBZ8cA5zmXyMgg",
            "created": "2021-03-19T02:59:21.309Z",
            "modified": "2021-03-19T02:59:21.309Z",
            "created_by": "5ff3fc3d521ab003d0293acf",
            "modified_by": "5ff3fc3d521ab003d0293acf",
            "company_id": "3TyAbA3xYadmNgDtd",
            "company_ids": [
                "3TyAbA3xYadmNgDtd"
            ],
            "name": "html__c"
        },
        "fn__c": {
            "object": "accounts",
            "label": "小计",
            "_name": "fn",
            "type": "formula",
            "precision": 18,
            "scale": 2,
            "formula": "ROUND((annual_revenue*0.02), 2)",
            "data_type": "currency",
            "formula_blank_value": "zeroes",
            "sort_no": 520,
            "is_name": false,
            "required": false,
            "is_wide": false,
            "readonly": false,
            "hidden": false,
            "omit": false,
            "index": false,
            "sortable": false,
            "searchable": false,
            "filterable": false,
            "space": "wspdRw3z3gqkWBWWF",
            "owner": "5ff3fc3d521ab003d0293acf",
            "_id": "LYtJRumQQiFi4rbSF",
            "created": "2021-03-19T03:13:35.149Z",
            "modified": "2021-03-19T03:13:35.149Z",
            "created_by": "5ff3fc3d521ab003d0293acf",
            "modified_by": "5ff3fc3d521ab003d0293acf",
            "company_id": "3TyAbA3xYadmNgDtd",
            "company_ids": [
                "3TyAbA3xYadmNgDtd"
            ],
            "name": "fn__c"
        }
    },
    "actions": {
        "standard_query": {
            "label": "查找",
            "visible": true,
            "on": "list",
            "todo": "standard_query"
        },
        "standard_new": {
            "label": "新建",
            "on": "list",
            "todo": "standard_new",
            "_visible": "function () {\r\n                var permissions;\r\n                permissions = Creator.getPermissions();\r\n                if (permissions) {\r\n                    return permissions[\"allowCreate\"];\r\n                }\r\n            }"
        },
        "standard_open_view": {
            "label": "查看",
            "visible": false,
            "on": "list_item",
            "todo": "standard_open_view"
        },
        "standard_edit": {
            "label": "编辑",
            "sort": 0,
            "on": "record",
            "todo": "standard_edit",
            "_visible": "function (object_name, record_id, record_permissions) {\r\n                var perms, record;\r\n                perms = {};\r\n                if (record_permissions) {\r\n                    perms = record_permissions;\r\n                } else {\r\n                    record = Creator.getObjectRecord(object_name, record_id);\r\n                    record_permissions = Creator.getRecordPermissions(object_name, record, Meteor.userId());\r\n                    if (record_permissions) {\r\n                        perms = record_permissions;\r\n                    }\r\n                }\r\n                return perms[\"allowEdit\"];\r\n            }"
        },
        "standard_delete": {
            "label": "删除",
            "on": "record_more",
            "todo": "standard_delete",
            "_visible": "function (object_name, record_id, record_permissions) {\r\n                var perms, record;\r\n                perms = {};\r\n                if (record_permissions) {\r\n                    perms = record_permissions;\r\n                } else {\r\n                    record = Creator.getObjectRecord(object_name, record_id);\r\n                    record_permissions = Creator.getRecordPermissions(object_name, record, Meteor.userId());\r\n                    if (record_permissions) {\r\n                        perms = record_permissions;\r\n                    }\r\n                }\r\n                return perms[\"allowDelete\"];\r\n            }"
        },
        "standard_approve": {
            "label": "发起审批",
            "on": "record",
            "_todo": "function () {\r\n                return Modal.show('initiate_approval', {\r\n                    object_name: this.object_name,\r\n                    record_id: this.record_id\r\n                });\r\n            }",
            "_visible": "function (object_name, record_id, record_permissions) {\r\n                if (!Session.get(\"record_id\")) {\r\n                    /*只在详细界面显示这个action*/\r\n                    return false;\r\n                }\r\n                var object_workflow, record;\r\n                if (record_permissions && !record_permissions[\"allowEdit\"]) {\r\n                    return false;\r\n                }\r\n                record = Creator.getObjectRecord(object_name, record_id);\r\n                record_permissions = Creator.getRecordPermissions(object_name, record, Meteor.userId());\r\n                if (record_permissions && !record_permissions[\"allowEdit\"]) {\r\n                    return false;\r\n                }\r\n                object_workflow = _.find(Creator.object_workflows, function (ow) {\r\n                    return ow.object_name === object_name;\r\n                });\r\n                if (!object_workflow) {\r\n                    return false;\r\n                }\r\n                if (record && record.instances && record.instances.length > 0) {\r\n                    return false;\r\n                }\r\n                return true;\r\n            }"
        },
        "standard_view_instance": {
            "label": "查看审批单",
            "on": "record",
            "_todo": "function () {\r\n                var data, instanceId, uobj, url;\r\n                instanceId = this.record.instances[0]._id;\r\n                if (!instanceId) {\r\n                    console.error('instanceId not exists');\r\n                    return;\r\n                }\r\n                uobj = {};\r\n                uobj['X-User-Id'] = Meteor.userId();\r\n                uobj['X-Auth-Token'] = Accounts._storedLoginToken();\r\n                data = {\r\n                    object_name: this.object_name,\r\n                    record_id: this.record_id,\r\n                    space_id: Session.get(\"spaceId\")\r\n                };\r\n                url = Steedos.absoluteUrl() + (\"api/workflow/view/\" + instanceId + \"?\") + $.param(uobj);\r\n                data = JSON.stringify(data);\r\n                $(document.body).addClass('loading');\r\n                return $.ajax({\r\n                    url: url,\r\n                    type: 'POST',\r\n                    async: true,\r\n                    data: data,\r\n                    dataType: 'json',\r\n                    processData: false,\r\n                    contentType: 'application/json',\r\n                    success: function (responseText, status) {\r\n                        $(document.body).removeClass('loading');\r\n                        if (responseText.errors) {\r\n                            responseText.errors.forEach(function (e) {\r\n                                toastr.error(e.errorMessage);\r\n                            });\r\n                            Template.creator_view.currentInstance.onEditSuccess();\r\n                            return;\r\n                        } else if (responseText.redirect_url) {\r\n                            if (Meteor.settings.public.webservices && Meteor.settings.public.webservices.workflow && Meteor.settings.public.webservices.workflow.url) {\r\n                                Steedos.openWindow(responseText.redirect_url);\r\n                            } else {\r\n                                Steedos.openWindow(Steedos.absoluteUrl(responseText.redirect_url));\r\n                            }\r\n\r\n                        }\r\n                    },\r\n                    error: function (xhr, msg, ex) {\r\n                        $(document.body).removeClass('loading');\r\n                        toastr.error(msg);\r\n                        Template.creator_view.currentInstance.onEditSuccess();\r\n                    }\r\n                });\r\n            }",
            "_visible": "function (object_name, record_id, record_permissions) {\r\n                if (!Session.get(\"record_id\")) {\r\n                    /*只在详细界面显示这个action*/\r\n                    return false;\r\n                }\r\n                var record;\r\n                record = Creator.getObjectRecord(object_name, record_id);\r\n                if (record && !_.isEmpty(record.instances)) {\r\n                    return true;\r\n                }\r\n                return false;\r\n            }"
        },
        "standard_follow": {
            "label": "关注",
            "on": "list",
            "_todo": "function () {\r\n                var follow = Creator.getCollection(\"follows\").findOne({ object_name: Session.get(\"object_name\") });\r\n                if (follow) {\r\n                    Creator.odata.delete('follows', follow._id, function () { });\r\n                } else {\r\n                    Creator.odata.insert('follows', { object_name: Session.get(\"object_name\") });\r\n                }\r\n            }",
            "_visible": "function () {\r\n                if (Creator.getObject()) {\r\n                    return Creator.getObject().enable_follow\r\n                }\r\n                return false;\r\n            }"
        },
        "standard_submit_for_approval": {
            "label": "提请批准",
            "on": "record_only_more",
            "_todo": "function (object_name, record_id) {\r\n                Steedos.ProcessManager.submit(object_name, record_id);\r\n            }",
            "_visible": "function (object_name, record_id) {\r\n                return Steedos.ProcessManager.allowSubmit(object_name, record_id);\r\n            }"
        },
        "enableSupplier": {
            "label": "作为供应商启用",
            "on": "record_only_more",
            "_todo": "function (object_name, record_id, fields) {\r\n        text = '启用后，可以为供应商关联的联系人创建供应商用户。是否确定？';\r\n        swal({\r\n            title: \"作为供应商启用\",\r\n            text: \"<div>\" + text + \"</div>\",\r\n            html: true,\r\n            showCancelButton: true,\r\n            confirmButtonText: t('YES'),\r\n            cancelButtonText: t('NO')\r\n        }, function (confirm) {\r\n            if(confirm){\r\n                Creator.odata.update('accounts', record_id, { is_supplier: true })\r\n            }\r\n            sweetAlert.close();\r\n        })\r\n    }",
            "_visible": "function (object_name, record_id, record_permissions) {\r\n        if(!Creator.isSpaceAdmin()){\r\n            return false\r\n        }\r\n        var record = Creator.getCollection(object_name).findOne(record_id);\r\n        if(record){\r\n            return record.is_supplier != true\r\n        }\r\n    }"
        },
        "disableSupplier": {
            "label": "禁用供应商账户",
            "on": "record_only_more",
            "_todo": "function (object_name, record_id, fields) {\r\n        text = '将禁用所有与此供应商关联的外部用户。 是否确定？';\r\n        swal({\r\n            title: \"禁用供应商账户\",\r\n            text: \"<div>\" + text + \"</div>\",\r\n            html: true,\r\n            showCancelButton: true,\r\n            confirmButtonText: t('YES'),\r\n            cancelButtonText: t('NO')\r\n        }, function (confirm) {\r\n            if(confirm){\r\n                Creator.odata.update('accounts', record_id, { is_supplier: false })\r\n            }\r\n            sweetAlert.close();\r\n        })\r\n    }",
            "_visible": "function(object_name, record_id, record_permissions){\r\n        if(!Creator.isSpaceAdmin()){\r\n            return false\r\n        }\r\n        var record = Creator.getCollection(object_name).findOne(record_id);\r\n        if(record){\r\n            return record.is_supplier\r\n        }\r\n    }"
        },
        "enableCustomer": {
            "label": "作为客户启用",
            "on": "record_only_more",
            "_todo": "function (object_name, record_id, fields) {\r\n        text = '启用后，可以为客户关联的联系人创建客户用户。是否确定？';\r\n        swal({\r\n            title: \"作为客户启用\",\r\n            text: \"<div>\" + text + \"</div>\",\r\n            html: true,\r\n            showCancelButton: true,\r\n            confirmButtonText: t('YES'),\r\n            cancelButtonText: t('NO')\r\n        }, function (confirm) {\r\n            if(confirm){\r\n                Creator.odata.update('accounts', record_id, { is_customer: true })\r\n            }\r\n            sweetAlert.close();\r\n        })\r\n    }",
            "_visible": "function (object_name, record_id, record_permissions) {\r\n        if(!Creator.isSpaceAdmin()){\r\n            return false\r\n        }\r\n        var record = Creator.getCollection(object_name).findOne(record_id);\r\n        if(record){\r\n            return record.is_customer != true\r\n        }\r\n    }"
        },
        "disableCustomer": {
            "label": "禁用客户账户",
            "on": "record_only_more",
            "_todo": "function (object_name, record_id, fields) {\r\n        text = '将禁用所有与此客户关联的外部用户。 是否确定？';\r\n        swal({\r\n            title: \"禁用客户账户\",\r\n            text: \"<div>\" + text + \"</div>\",\r\n            html: true,\r\n            showCancelButton: true,\r\n            confirmButtonText: t('YES'),\r\n            cancelButtonText: t('NO')\r\n        }, function (confirm) {\r\n            if(confirm){\r\n                Creator.odata.update('accounts', record_id, { is_customer: false })\r\n            }\r\n            sweetAlert.close();\r\n        })\r\n    }",
            "_visible": "function(object_name, record_id, record_permissions){\r\n        if(!Creator.isSpaceAdmin()){\r\n            return false\r\n        }\r\n        var record = Creator.getCollection(object_name).findOne(record_id);\r\n        if(record){\r\n            return record.is_customer\r\n        }\r\n    }"
        }
    },
    "permission_set": {
        "none": {
            "allowCreate": false,
            "allowDelete": false,
            "allowEdit": false,
            "allowRead": false,
            "modifyAllRecords": false,
            "name": "none"
        },
        "user": {
            "allowCreate": true,
            "allowDelete": true,
            "allowEdit": true,
            "allowRead": true,
            "modifyAllRecords": false,
            "viewAllRecords": true,
            "name": "user"
        },
        "admin": {
            "allowCreate": true,
            "allowDelete": true,
            "allowEdit": true,
            "allowRead": true,
            "modifyAllRecords": true,
            "viewAllRecords": true,
            "name": "admin"
        },
        "contract_manager": {
            "allowCreate": true,
            "allowEdit": true,
            "allowDelete": true,
            "allowRead": true,
            "modifyAllRecords": true,
            "viewAllRecords": true,
            "name": "contract_manager"
        }
    },
    "datasource": "default",
    "triggers": {
        "before.update.server.disableSpaceUsers": {
            "on": "server",
            "when": "before.update"
        },
        "after.update.server.disableSpaceUsers": {
            "on": "server",
            "when": "after.update"
        }
    },
    "listeners": {
        "99914b932bd37a50b983c5e7c90ae93b": {
            "name": "99914b932bd37a50b983c5e7c90ae93b"
        }
    },
    "label": "客户",
    "icon": "account",
    "enable_files": true,
    "enable_search": true,
    "enable_events": true,
    "enable_tasks": true,
    "enable_api": true,
    "enable_share": true,
    "enable_audit": true,
    "list_views": {
        "recent": {
            "label": "最近查看",
            "columns": [
                {
                    "field": "name",
                    "width": 300,
                    "wrap": true
                },
                {
                    "field": "type",
                    "width": 120
                },
                {
                    "field": "rating",
                    "width": 120
                },
                {
                    "field": "billing_address",
                    "width": 400
                },
                {
                    "field": "shipping_address",
                    "width": 400
                },
                {
                    "field": "owner",
                    "width": 120
                }
            ],
            "filter_scope": "space",
            "filter_fields": [
                "type",
                "industry",
                "rating",
                "name"
            ]
        },
        "all": {
            "label": "所有客户",
            "columns": [
                {
                    "field": "name",
                    "width": 300,
                    "wrap": true
                },
                {
                    "field": "type",
                    "width": 120
                },
                {
                    "field": "rating",
                    "width": 120
                },
                {
                    "field": "billing_address",
                    "width": 400
                },
                {
                    "field": "shipping_address",
                    "width": 400
                },
                {
                    "field": "owner",
                    "width": 120
                }
            ],
            "filter_scope": "space",
            "filter_fields": [
                "type",
                "industry",
                "rating",
                "name"
            ]
        },
        "allCustomers": {
            "label": "所有顾客",
            "columns": [
                {
                    "field": "name",
                    "width": 300,
                    "wrap": true
                },
                {
                    "field": "type",
                    "width": 120
                },
                {
                    "field": "rating",
                    "width": 120
                },
                {
                    "field": "billing_address",
                    "width": 400
                },
                {
                    "field": "shipping_address",
                    "width": 400
                },
                {
                    "field": "owner",
                    "width": 120
                }
            ],
            "filter_scope": "space",
            "filter_fields": [
                "type",
                "industry",
                "name"
            ],
            "_filters": "function anonymous(\n) {\n\n    return [\n      [\"type\",\"=\",\"Customer\"]\n    ];\n\n}"
        },
        "hotRating": {
            "label": "非常重要的客户",
            "columns": [
                {
                    "field": "name",
                    "width": 300,
                    "wrap": true
                },
                {
                    "field": "type",
                    "width": 120
                },
                {
                    "field": "rating",
                    "width": 120
                },
                {
                    "field": "billing_address",
                    "width": 400
                },
                {
                    "field": "shipping_address",
                    "width": 400
                },
                {
                    "field": "owner",
                    "width": 120
                }
            ],
            "filter_scope": "space",
            "filter_fields": [
                "type",
                "industry",
                "name"
            ],
            "_filters": "function anonymous(\n) {\n\n    return [\n      [\"rating\",\"=\",\"hot\"]\n    ];\n\n}"
        },
        "mine": {
            "label": "我的客户",
            "columns": [
                {
                    "field": "name",
                    "width": 300,
                    "wrap": true
                },
                {
                    "field": "type",
                    "width": 120
                },
                {
                    "field": "rating",
                    "width": 120
                },
                {
                    "field": "billing_address",
                    "width": 400
                },
                {
                    "field": "shipping_address",
                    "width": 400
                },
                {
                    "field": "owner",
                    "width": 120
                }
            ],
            "filter_scope": "mine",
            "filter_fields": [
                "type",
                "industry",
                "rating",
                "name"
            ]
        }
    },
    "fields_serial_number": 530,
    "relatedList": [],
    "permissions": {
        "allowCreate": true,
        "allowDelete": true,
        "allowEdit": true,
        "allowRead": true,
        "modifyAllRecords": true,
        "viewAllRecords": true,
        "name": "admin"
    },
    "description": ""
}